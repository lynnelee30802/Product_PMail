<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>PMail - PM ç™¼ä¿¡å°å¹«æ‰‹</title>

  <style>
    /* ===== åŸºæœ¬ç‰ˆå‹è¨­å®š ===== */
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
        "Noto Sans TC", "Microsoft JhengHei", sans-serif;
      background: #f5f7fb;
      color: #333;
    }

    .app-container {
      max-width: 960px;
      margin: 40px auto;
      padding: 24px;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(15, 23, 42, 0.08);
    }

    h1 {
      margin: 0 0 4px;
      font-size: 28px;
      font-weight: 700;
      letter-spacing: 0.04em;
      color: #1f2933;
    }

    .subtitle {
      margin-bottom: 24px;
      color: #6b7280;
      font-size: 14px;
    }

    /* ===== è¡¨å–®å€å¡Š ===== */
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px 24px;
      margin-bottom: 24px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .form-group.full {
      grid-column: 1 / -1; /* ä½”æ»¿æ•´åˆ— */
    }

    label {
      font-size: 13px;
      font-weight: 600;
      color: #374151;
    }

    label span.hint {
      font-weight: 400;
      font-size: 11px;
      color: #9ca3af;
      margin-left: 4px;
    }

    input[type="text"],
    textarea {
      border-radius: 8px;
      border: 1px solid #d1d5db;
      padding: 8px 10px;
      font-size: 13px;
      transition: border-color 0.15s ease, box-shadow 0.15s ease;
      font-family: inherit;
      resize: vertical;
      min-height: 38px;
    }

    textarea {
      min-height: 80px;
      line-height: 1.5;
    }

    input[type="text"]:focus,
    textarea:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.15);
    }

    input::placeholder,
    textarea::placeholder {
      color: #9ca3af;
      font-size: 12px;
    }

    /* ===== æŒ‰éˆ•å€ ===== */
    .actions {
      display: flex;
      gap: 12px;
      margin-bottom: 24px;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.08s ease, box-shadow 0.08s ease,
        background-color 0.12s ease;
    }

    button.primary {
      background: #2563eb;
      color: #ffffff;
      box-shadow: 0 6px 16px rgba(37, 99, 235, 0.25);
    }

    button.primary:hover {
      background: #1d4ed8;
      transform: translateY(-1px);
      box-shadow: 0 10px 24px rgba(37, 99, 235, 0.28);
    }

    button.secondary {
      background: #e5e7eb;
      color: #374151;
    }

    button.secondary:hover {
      background: #d1d5db;
    }

    button:active {
      transform: translateY(0);
      box-shadow: none;
    }

    /* ===== è¼¸å‡ºå€å¡Š ===== */
    .output-card {
      border-radius: 14px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      padding: 16px 16px 20px;
    }

    .output-header {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #111827;
    }

    .output-subject {
      font-family: "SFMono-Regular", ui-monospace, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      padding: 6px 8px;
      border-radius: 8px;
      background: #111827;
      color: #f9fafb;
      overflow-x: auto;
      white-space: nowrap;
      margin-bottom: 12px;
    }

    .output-body {
      white-space: pre-wrap; /* è®“ \n æ­£ç¢ºæ›è¡Œ */
      font-size: 13px;
      line-height: 1.6;
      background: #ffffff;
      border-radius: 10px;
      padding: 12px 14px;
      border: 1px solid #e5e7eb;
      max-height: 420px;
      overflow-y: auto;
    }

    .output-empty {
      font-size: 12px;
      color: #9ca3af;
      font-style: italic;
    }

    .output-toolbar {
      display: flex;
      justify-content: flex-end;
      margin-top: 10px;
    }

    .copy-hint {
      font-size: 11px;
      color: #6b7280;
      margin-right: auto;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .status-text {
      font-size: 11px;
      color: #16a34a;
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .status-text.visible {
      opacity: 1;
    }

    /* ===== RWD èª¿æ•´ ===== */
    @media (max-width: 768px) {
      .app-container {
        margin: 16px;
        padding: 16px;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="app-container">
    <h1>PMail</h1>
    <div class="subtitle">PM ç™¼ä¿¡å°å¹«æ‰‹ï½œä¸€éµç”Ÿæˆå°ˆæ¥­ã€æ¢ç†æ¸…æ™°çš„å°ˆæ¡ˆé€²åº¦å›å ± Email</div>

    <!-- ===== è¼¸å…¥å€ï¼šåŸºæœ¬è³‡è¨Šèˆ‡å°ˆæ¡ˆå…§å®¹ ===== -->
    <div class="form-grid">
      <!-- å°ˆæ¡ˆåç¨± -->
      <div class="form-group">
        <label for="projectName">
          å°ˆæ¡ˆåç¨±
          <span class="hint">ï¼ˆä¾‹å¦‚ï¼šä¼æ¥­å…§éƒ¨ç³»çµ±å„ªåŒ–å°ˆæ¡ˆï¼‰</span>
        </label>
        <input
          type="text"
          id="projectName"
          placeholder="è«‹è¼¸å…¥å°ˆæ¡ˆåç¨±"
        />
      </div>

      <!-- å®¢æˆ¶ç¨±å‘¼ -->
      <div class="form-group">
        <label for="clientName">
          å®¢æˆ¶ç¨±å‘¼
          <span class="hint">ï¼ˆä¾‹å¦‚ï¼šABC ç§‘æŠ€å°ˆæ¡ˆåœ˜éšŠã€ç‹å…ˆç”Ÿï¼‰</span>
        </label>
        <input
          type="text"
          id="clientName"
          placeholder="ä¾‹å¦‚ï¼šABC ç§‘æŠ€å°ˆæ¡ˆåœ˜éšŠ"
        />
      </div>

      <!-- æœ¬é€±é€²åº¦æ‘˜è¦ -->
      <div class="form-group full">
        <label for="summary">
          å°ˆæ¡ˆé€²åº¦æ‘˜è¦
          <span class="hint">ï¼ˆä¸€è‡³å…©æ®µï¼Œèªªæ˜æ•´é«”ç‹€æ…‹ï¼‰</span>
        </label>
        <textarea
          id="summary"
          placeholder="ä¾‹å¦‚ï¼šæœ¬é€±æ•´é«”é€²åº¦å¦‚æœŸé€²è¡Œï¼Œå·²å®Œæˆæ ¸å¿ƒåŠŸèƒ½é–‹ç™¼èˆ‡ä»‹é¢èª¿æ•´ï¼Œç›®å‰å·²é€²å…¥ç³»çµ±æ¸¬è©¦éšæ®µã€‚"
        ></textarea>
      </div>

      <!-- å·²å®Œæˆé …ç›® -->
      <div class="form-group full">
        <label for="completed">
          å·²å®Œæˆé …ç›®
          <span class="hint">ï¼ˆæ¯è¡Œä¸€é …ï¼Œå°‡è‡ªå‹•è½‰ç‚ºæ¢åˆ—ï¼‰</span>
        </label>
        <textarea
          id="completed"
          placeholder="- å®Œæˆæ ¸å¿ƒæ¨¡çµ„éœ€æ±‚ç¢ºèªèˆ‡æ¬„ä½å®šç¾©
- å®Œæˆä¸»è¦ä»‹é¢è¨­è¨ˆèˆ‡æ–‡æ¡ˆå®šç¨¿
- å®Œæˆèˆ‡ç¬¬ä¸‰æ–¹æœå‹™ä¹‹ API æ¸¬è©¦é©—è­‰"
        ></textarea>
      </div>

      <!-- é€²è¡Œä¸­é …ç›®èˆ‡é è¨ˆå®Œæˆæ™‚é–“ -->
      <div class="form-group full">
        <label for="inProgress">
          é€²è¡Œä¸­é …ç›®èˆ‡é è¨ˆå®Œæˆæ™‚é–“
          <span class="hint">ï¼ˆæ¯è¡Œä¸€é …ï¼Œå¯åŠ å…¥é ä¼°å®Œæˆæ™‚é–“ï¼‰</span>
        </label>
        <textarea
          id="inProgress"
          placeholder="- UAT æ¸¬è©¦ï¼ˆé è¨ˆ 12/15 å‰å®Œæˆï¼‰
- ç³»çµ±æ•´åˆæ¸¬è©¦èˆ‡æ€§èƒ½é©—è­‰ï¼ˆé è¨ˆ 12/18 å‰å®Œæˆï¼‰"
        ></textarea>
      </div>

      <!-- ä¸‹ä¸€æ­¥è¨ˆç•« / å¾…å®¢æˆ¶ç¢ºèªäº‹é … -->
      <div class="form-group full">
        <label for="nextSteps">
          ä¸‹ä¸€æ­¥è¨ˆç•« / å¾…å®¢æˆ¶ç¢ºèªäº‹é …
          <span class="hint">ï¼ˆæ¯è¡Œä¸€é …ï¼‰</span>
        </label>
        <textarea
          id="nextSteps"
          placeholder="- è«‹å”åŠ©ç¢ºèª UAT æ¸¬è©¦æ™‚æ®µèˆ‡åƒèˆ‡æˆå“¡åå–®
- è«‹æä¾›æ­£å¼ä¸Šç·šå‰æ“ä½œæ•™è‚²è¨“ç·´çš„æ™‚ç¨‹åå¥½èˆ‡åƒè€ƒå…§å®¹"
        ></textarea>
      </div>

      <!-- ç™¼ä¿¡äººåç¨± -->
      <div class="form-group">
        <label for="senderName">
          ç™¼ä¿¡äººåç¨±
          <span class="hint">ï¼ˆçµå°¾ç°½åä½¿ç”¨ï¼‰</span>
        </label>
        <input
          type="text"
          id="senderName"
          placeholder="ä¾‹å¦‚ï¼šå°ˆæ¡ˆç¶“ç† David"
        />
      </div>

      <!-- çµå°¾å•å€™èª -->
      <div class="form-group">
        <label for="closing">
          çµå°¾å•å€™èª
          <span class="hint">ï¼ˆå¯è‡ªè¡Œèª¿æ•´ï¼‰</span>
        </label>
        <input
          type="text"
          id="closing"
          placeholder="ä¾‹å¦‚ï¼šè‹¥æœ‰ä»»ä½•å•é¡Œï¼Œæ­¡è¿éš¨æ™‚èˆ‡æˆ‘è¯ç¹«ï¼Œè¬è¬ã€‚"
        />
      </div>

      <!-- å¯è²¼ä¸ŠåŸå§‹è‰ç¨¿ï¼šé¸æ“‡æ€§ä½¿ç”¨ -->
      <div class="form-group full">
        <label for="rawDraft">
          åŸå§‹å°ˆæ¡ˆå…§å®¹ / è‰ç¨¿ï¼ˆé¸å¡«ï¼‰
          <span class="hint">ï¼ˆè‹¥æœ‰è¼ƒé›œçš„ç­†è¨˜ï¼Œå¯è²¼åœ¨æ­¤å€ï¼ŒPMail æœƒå°‡å…¶é›†ä¸­æ”¾åœ¨é€²åº¦æ‘˜è¦ä¸­ï¼‰</span>
        </label>
        <textarea
          id="rawDraft"
          placeholder="å¯è²¼ä¸Šä½ åŸæœ¬å¯«çµ¦è‡ªå·±çš„å‚™å¿˜ã€éœ€æ±‚å½™æ•´æˆ–ç°¡çŸ­è‰ç¨¿ï¼Œç³»çµ±æœƒå°‡å…§å®¹æ•´ç†é€²ä¿¡ä»¶ä¸­ã€‚"
        ></textarea>
      </div>
    </div>

    <!-- ===== å‹•ä½œæŒ‰éˆ• ===== -->
    <div class="actions">
      <button class="primary" id="generateBtn">
        ğŸš€ ç”¢ç”Ÿ Email
      </button>
      <button class="secondary" id="resetBtn">
        ğŸ§¹ æ¸…ç©ºæ¬„ä½
      </button>
    </div>

    <!-- ===== è¼¸å‡ºçµæœå€ï¼šEmail ä¸»æ—¨èˆ‡å…§æ–‡ ===== -->
    <div class="output-card">
      <div class="output-header">è¼¸å‡ºçµæœï¼ˆEmail æ¨£å¼ï¼‰</div>

      <!-- ä¸»æ—¨ -->
      <div class="output-subject" id="outputSubject">
        ï¼ˆè«‹å…ˆé»é¸ã€Œç”¢ç”Ÿ Emailã€ï¼‰
      </div>

      <!-- å…§æ–‡ -->
      <div class="output-body" id="outputBody">
        <span class="output-empty">
          é€™è£¡å°‡é¡¯ç¤º PMail ç‚ºä½ ç”¢ç”Ÿçš„å°ˆæ¡ˆé€²åº¦å›å ±ä¿¡ã€‚<br />
          å…§å®¹æœƒåŒ…å«ï¼šä¸»æ—¨ã€å•å€™èªã€å°ˆæ¡ˆé€²åº¦æ‘˜è¦ã€å·²å®Œæˆé …ç›®ã€é€²è¡Œä¸­é …ç›®èˆ‡é è¨ˆå®Œæˆæ™‚é–“ã€ä¸‹ä¸€æ­¥è¨ˆç•«ï¼å¾…å®¢æˆ¶ç¢ºèªäº‹é …ä»¥åŠçµå°¾æ„Ÿè¬èªã€‚
        </span>
      </div>

      <!-- è¤‡è£½å·¥å…·åˆ— -->
      <div class="output-toolbar">
        <div class="copy-hint">
          âŒ¨ï¸ å°æé†’ï¼šå¯ç›´æ¥è¤‡è£½è²¼ä¸Šåˆ° Outlook / Gmail å†åšå¾®èª¿
        </div>
        <span class="status-text" id="copyStatus">å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿</span>
        <button class="secondary" id="copyBtn">
          ğŸ“‹ è¤‡è£½å…§æ–‡
        </button>
      </div>
    </div>
  </div>

  <script>
    // ===== å–å¾— DOM å…ƒç´  =====
    const projectNameInput = document.getElementById("projectName");
    const clientNameInput = document.getElementById("clientName");
    const summaryInput = document.getElementById("summary");
    const completedInput = document.getElementById("completed");
    const inProgressInput = document.getElementById("inProgress");
    const nextStepsInput = document.getElementById("nextSteps");
    const senderNameInput = document.getElementById("senderName");
    const closingInput = document.getElementById("closing");
    const rawDraftInput = document.getElementById("rawDraft");

    const generateBtn = document.getElementById("generateBtn");
    const resetBtn = document.getElementById("resetBtn");
    const copyBtn = document.getElementById("copyBtn");

    const outputSubject = document.getElementById("outputSubject");
    const outputBody = document.getElementById("outputBody");
    const copyStatus = document.getElementById("copyStatus");

    /**
     * å°‡å¤šè¡Œæ–‡å­—è½‰æ›æˆæ¢åˆ—å­—ä¸²
     * æ¯è¡Œæœƒè‡ªå‹•åŠ ä¸Šã€Œï¼ã€é–‹é ­ï¼Œä¸¦å¿½ç•¥ç©ºç™½è¡Œ
     */
    function convertToBulletLines(text) {
      if (!text) return "";
      return text
        .split("\n")
        .map((line) => line.trim())
        .filter((line) => line.length > 0)
        .map((line) => "ï¼" + line)
        .join("\n");
    }

    /**
     * å–å¾—ä»Šæ—¥æ—¥æœŸå­—ä¸²ï¼ˆYYYY/MM/DDï¼‰
     */
    function getTodayString() {
      const now = new Date();
      const y = now.getFullYear();
      const m = String(now.getMonth() + 1).padStart(2, "0");
      const d = String(now.getDate()).padStart(2, "0");
      return `${y}/${m}/${d}`;
    }

    /**
     * ç”¢ç”Ÿ Email ä¸»æ—¨
     */
    function buildSubject(projectName) {
      const today = getTodayString();
      const name = projectName ? projectName.trim() : "å°ˆæ¡ˆ";
      return `ã€å°ˆæ¡ˆé€²åº¦æ›´æ–°ã€‘${name} - æˆªè‡³ ${today}`;
    }

    /**
     * ç”¢ç”Ÿ Email å…§æ–‡
     * ç¬¦åˆï¼šä¸»æ—¨ã€å•å€™èªã€å°ˆæ¡ˆé€²åº¦æ‘˜è¦ã€å·²å®Œæˆé …ç›®ã€
     *       é€²è¡Œä¸­é …ç›®èˆ‡é è¨ˆå®Œæˆæ™‚é–“ã€ä¸‹ä¸€æ­¥è¨ˆç•«ï¼å¾…å®¢æˆ¶ç¢ºèªäº‹é …ã€çµå°¾æ„Ÿè¬èª
     */
    function buildEmailBody({
      projectName,
      clientName,
      summary,
      completed,
      inProgress,
      nextSteps,
      senderName,
      closing,
      rawDraft,
    }) {
      const today = getTodayString();

      const safeProjectName = projectName.trim() || "æœ¬å°ˆæ¡ˆ";
      const safeClientName = clientName.trim() || "è²´åœ˜éšŠ";
      const safeSender = senderName.trim() || "å°ˆæ¡ˆè² è²¬äºº";
      const safeClosing =
        closing.trim() || "è‹¥æœ‰ä»»ä½•å•é¡Œï¼Œæ­¡è¿éš¨æ™‚èˆ‡æˆ‘è¯ç¹«ï¼Œè¬è¬ã€‚";

      // è‹¥æ²’æœ‰å¡«æ‘˜è¦ï¼Œä½†æœ‰è²¼è‰ç¨¿ï¼Œå°±æŠŠè‰ç¨¿ç•¶æˆæ‘˜è¦è£œä¸Š
      let summaryContent = summary.trim();
      if (!summaryContent && rawDraft.trim()) {
        summaryContent =
          "ä»¥ä¸‹ç‚ºæœ¬é€±å°ˆæ¡ˆé‡é»èªªæ˜ï¼Œä¾æ“šæ‚¨æä¾›ä¹‹å…§å®¹æ•´ç†å¦‚ä¸‹ï¼š" +
          "\n" +
          rawDraft.trim();
      } else if (summaryContent && rawDraft.trim()) {
        // è‹¥å…©è€…éƒ½æœ‰ï¼Œå‰‡åœ¨æ‘˜è¦å¾Œé¢é™„è¨»è‰ç¨¿æ•´ç†
        summaryContent +=
          "\n\nè£œå……èªªæ˜ï¼ˆä¾æ“šå…§éƒ¨è‰ç¨¿æ•´ç†ï¼‰ï¼š\n" + rawDraft.trim();
      }

      const bulletCompleted = convertToBulletLines(completed);
      const bulletInProgress = convertToBulletLines(inProgress);
      const bulletNextSteps = convertToBulletLines(nextSteps);

      // ---- Email å…§æ–‡çµæ§‹ ----
      const lines = [];

      // å•å€™èª
      lines.push(`${safeClientName}æ‚¨å¥½ï¼š`);
      lines.push(""); // ç©ºè¡Œ

      // é–‹é ­èªªæ˜
      lines.push(
        `é€™å°ä¿¡ä¸»è¦å‘æ‚¨å›å ±ã€Œ${safeProjectName}ã€æˆªè‡³ ${today} çš„å°ˆæ¡ˆé€²åº¦ï¼Œä»¥ä¸‹ç‚ºæœ¬é€±é‡é»æ‘˜è¦èˆ‡å¾ŒçºŒè¦åŠƒèªªæ˜ï¼Œä¾›æ‚¨åƒè€ƒã€‚`
      );
      lines.push("");

      // å°ˆæ¡ˆé€²åº¦æ‘˜è¦
      lines.push("ä¸€ã€å°ˆæ¡ˆé€²åº¦æ‘˜è¦");
      lines.push(
        summaryContent ||
          "æœ¬é€±å°ˆæ¡ˆæ•´é«”é€²åº¦ç©©å®šæ¨é€²ï¼Œç›¸é—œé …ç›®å‡ä¾åŸè¨‚è¨ˆç•«é€²è¡Œä¸­ã€‚"
      );
      lines.push("");

      // å·²å®Œæˆé …ç›®
      lines.push("äºŒã€å·²å®Œæˆé …ç›®");
      if (bulletCompleted) {
        lines.push(bulletCompleted);
      } else {
        lines.push("ï¼ç›®å‰å·²å®Œæˆæœ¬éšæ®µé å®šä¹‹ä¸»è¦è¦åŠƒèˆ‡è¨­å®šé …ç›®ã€‚");
      }
      lines.push("");

      // é€²è¡Œä¸­é …ç›®èˆ‡é è¨ˆå®Œæˆæ™‚é–“
      lines.push("ä¸‰ã€é€²è¡Œä¸­é …ç›®èˆ‡é è¨ˆå®Œæˆæ™‚é–“");
      if (bulletInProgress) {
        lines.push(bulletInProgress);
      } else {
        lines.push(
          "ï¼ç›¸é—œé–‹ç™¼èˆ‡æ¸¬è©¦ä½œæ¥­æ­£ä¾æ™‚ç¨‹æ¨é€²ï¼Œè‹¥æœ‰æ™‚ç¨‹èª¿æ•´æœƒå†ç¬¬ä¸€æ™‚é–“èˆ‡æ‚¨èªªæ˜ã€‚"
        );
      }
      lines.push("");

      // ä¸‹ä¸€æ­¥è¨ˆç•« / å¾…å®¢æˆ¶ç¢ºèªäº‹é …
      lines.push("å››ã€ä¸‹ä¸€æ­¥è¨ˆç•« / å¾…å®¢æˆ¶ç¢ºèªäº‹é …");
      if (bulletNextSteps) {
        lines.push(bulletNextSteps);
      } else {
        lines.push("ï¼å¾ŒçºŒå°‡ä¾æ—¢å®šæ™‚ç¨‹å®‰æ’æ­£å¼ä¸Šç·šå‰æ¸¬è©¦èˆ‡æ•™è‚²è¨“ç·´äº‹å®œã€‚");
      }
      lines.push("");

      // çµå°¾æ„Ÿè¬èª
      lines.push(safeClosing);
      lines.push("");
      lines.push(`æ­¤è‡´`);
      lines.push("");
      lines.push(`æ•¬ç¥ é †å¿ƒ`);
      lines.push("");
      lines.push(safeSender);

      return lines.join("\n");
    }

    /**
     * ç”Ÿæˆ Emailï¼Œæ›´æ–°ç•«é¢
     */
    function generateEmail() {
      const projectName = projectNameInput.value;
      const clientName = clientNameInput.value;
      const summary = summaryInput.value;
      const completed = completedInput.value;
      const inProgress = inProgressInput.value;
      const nextSteps = nextStepsInput.value;
      const senderName = senderNameInput.value;
      const closing = closingInput.value;
      const rawDraft = rawDraftInput.value;

      // ä¸»æ—¨
      const subject = buildSubject(projectName);
      outputSubject.textContent = subject;

      // å…§æ–‡
      const body = buildEmailBody({
        projectName,
        clientName,
        summary,
        completed,
        inProgress,
        nextSteps,
        senderName,
        closing,
        rawDraft,
      });

      // æŠŠç”¢ç”Ÿçš„æ–‡å­—æ”¾åˆ°è¼¸å‡ºå€ï¼ˆä½¿ç”¨ pre-wrap é¡¯ç¤ºæ›è¡Œï¼‰
      outputBody.textContent = body;
    }

    /**
     * æ¸…ç©ºæ‰€æœ‰è¼¸å…¥èˆ‡è¼¸å‡º
     */
    function resetAll() {
      projectNameInput.value = "";
      clientNameInput.value = "";
      summaryInput.value = "";
      completedInput.value = "";
      inProgressInput.value = "";
      nextStepsInput.value = "";
      senderNameInput.value = "";
      closingInput.value = "";
      rawDraftInput.value = "";

      outputSubject.textContent = "ï¼ˆè«‹å…ˆé»é¸ã€Œç”¢ç”Ÿ Emailã€ï¼‰";
      outputBody.innerHTML =
        '<span class="output-empty">é€™è£¡å°‡é¡¯ç¤º PMail ç‚ºä½ ç”¢ç”Ÿçš„å°ˆæ¡ˆé€²åº¦å›å ±ä¿¡ã€‚<br />å…§å®¹æœƒåŒ…å«ï¼šä¸»æ—¨ã€å•å€™èªã€å°ˆæ¡ˆé€²åº¦æ‘˜è¦ã€å·²å®Œæˆé …ç›®ã€é€²è¡Œä¸­é …ç›®èˆ‡é è¨ˆå®Œæˆæ™‚é–“ã€ä¸‹ä¸€æ­¥è¨ˆç•«ï¼å¾…å®¢æˆ¶ç¢ºèªäº‹é …ä»¥åŠçµå°¾æ„Ÿè¬èªã€‚</span>';
    }

    /**
     * è¤‡è£½ Email å…§æ–‡åˆ°å‰ªè²¼ç°¿
     */
    async function copyBodyToClipboard() {
      const text = outputBody.textContent.trim();
      if (!text) return;

      try {
        await navigator.clipboard.writeText(text);
        copyStatus.classList.add("visible");
        setTimeout(() => {
          copyStatus.classList.remove("visible");
        }, 1500);
      } catch (e) {
        alert("è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•é¸å–å¾Œä½¿ç”¨ Ctrl+C / Cmd+C è¤‡è£½ã€‚");
      }
    }

    // ===== ç¶å®šäº‹ä»¶ =====
    generateBtn.addEventListener("click", generateEmail);
    resetBtn.addEventListener("click", resetAll);
    copyBtn.addEventListener("click", copyBodyToClipboard);
  </script>
</body>
</html>
